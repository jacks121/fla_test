# 花苗流程自动化方案（速度优先，渐进扩展）

日期：2026-01-31  
目标：在不改变核心操作习惯的前提下，把“记录动作”变成“扫码动作”，优先提升速度，同时保留可扩展性。

---

## 关键前提（已确认）
- 培养皿不复用；编号永不复用  
- 先用手机，后续可接入扫码枪/手持终端  
- 环境干燥，标签受损风险低  
- 位置可贴码  
- 未来存在“换皿/转移”

---

## 方案核心（推荐方向）
### 1) 预印唯一ID二维标签 + 位置码
- **培养皿标签**：预印唯一ID（二维码/数据矩阵 + 人眼短码）。  
- **位置标签**：培育架/层/位贴码，用于“扫位置”。  
> 目的：现场只做“扫”，不做“写/录”。

### 2) 逻辑上分离 plant_id 与 dish_id
- **plant_id**：花苗终身ID，不变。  
- **dish_id**：培养皿ID，可变化。  
> 即使前台只扫一个码，后台仍保留可扩展性（换皿/转移必需）。

---

## 操作流程（速度优先版本）
### A. 创建 / 拆分 / 合并（不强制位置）
1) 扫父花苗（0/1/多）  
2) 依次扫新培养皿标签  
3) 系统自动生成“操作记录 + 父子关系”

### B. 上架 / 摆放（独立批量流程）
- **同一位置多皿**：先扫位置码 → 连扫多个培养皿  
- **分散位置**：逐个“位置码 → 培养皿”

### C. 巡查 / 状态更新
扫培养皿 → 点选状态（感染/变异/正常…）

### D. 换皿 / 转移（已确认存在）
1) 扫旧培养皿  
2) 扫新培养皿  
3) 系统生成“转移记录”，plant_id 绑定到新 dish_id  
4) 旧 dish_id 标记退役

---

## 扫码模式（提速关键）
- **连扫父 → 多子**：拆分时父花苗扫一次，连续扫多个新皿  
- **连扫位 → 多皿**：上架时位置扫一次，连续扫多个皿  
- **撤销最近 1–3 步**：扫错可快速回滚  
- **顺序校验**：父→子 / 旧→新，减少关系错误

---

## 标签与编号生命周期
- **编号不复用**：历史完整追溯  
- **标签三态**：未用 / 已用 / 作废  
- **“清理条码”变成“库存管理”**：无需删除历史，只管理未用标签库存

### 条码形态选择（速度优先）
- **二维优先（二维码/数据矩阵）**：信息密度高、容错强、手机识别稳定  
- **一维条码**：更长更窄，对准要求高，现场效率通常不如二维  
> 推荐二维为主；后续接入扫码枪/PDA时无需改变标签形态。

### 标签生成方式（考虑成本与速度）
- **推荐：预印批量标签**，现场只“拿-贴-扫”，不占用时间  
- **备选：现场按需打印**，减少库存但增加操作与故障风险  
> 速度优先场景建议“预印 + 库存管理”。

---

## 数据模型（极简可扩展）
- **花苗（plant）**：plant_id，品种/阶段/状态  
- **培养皿（dish）**：dish_id，当前绑定 plant_id  
- **操作记录（event）**：类型、操作人、时间、输入花苗、输出花苗  
- **位置（location）**：架/层/位  
- **人员（staff）**：员工信息与绩效

---

## 设备路线（渐进扩展）
1) **起步**：手机扫码（上线最快）  
2) **中期**：扫码枪并行（同流程更快）  
3) **后期**：手持终端（PDA/工业设备，流程不变）

---

## 预期收益（速度优先）
- 拆分/合并只需“扫-扫-扫”，不写纸、不回录  
- 位置记录从“繁忙时段”移到“摆放批量”阶段  
- 父子关系自动维护，减少后续统计返工

---

## 上线步骤（低风险）
1) 先上线“拆分/合并 + 批量上架”  
2) 再上线“状态巡查”  
3) 最后接入扫码枪或手持终端  
4) 全程保留撤销与异常提示

---

## 待你确认的细节（后续）
- 标签尺寸与可读短码长度  
- 批量扫时的“结束”动作（按钮 / 自动超时）  
- 状态枚举（感染/变异…）的初始集合
